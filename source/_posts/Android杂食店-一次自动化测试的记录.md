---
title: Android杂食店-一次自动化测试的记录
date: 2021-06-10 21:28:52
tags:
---

# Android杂食店-一次自动化测试的记录

> 是的, 每周一个自定义View的系列第二周就咕咕咕了, 因为我平时使用的工具各种各样, 实在是没有什么办法归为一类来处理, 现在想想, 这里平时实际工作使用的工具反而是更应该分享给大家的, 于是便有了现在新的系列Android杂食店, 多吃才能更好学习不是.

## 背景
最近一直在做一个蓝牙通信的项目, 由于通信的情况不是很稳定, 就像做一个冒烟测试看一下具体的情况, 不过现场十分的复杂, 需要延时通信, 异步的获取结果, 在根据结果决定相关的操作, 既不是白盒也不是黑盒. 因为是针对开发功能的测试, 纯黑盒的情况下无法获取到一些检测的数据, 而纯白盒的情况下又有许多的功能以及被集成, 只不过没有数据的显示. 加之功能测试流程复杂, 重复性高, 最后通过adb和shell进行了测试

## 设计与实现
测试的设计来说还是比较简单的, 打开应用-> 检查状态 -> 测试功能1 -> 测试功能2 -> 退出应用 -> 统计信息 -> 下一次循环测试

不过现实起来还是比较麻烦, 既有log日志的信息截取, 还有页面点击的事件触发, 在测试背景也不是需要十分的标准, 需要一个快速测试验证的情况下, 排查了使用辅助功能或者现有的黑白盒测试工具, 采用了adb+shell的方式

简单来说通过adb 来进行输出数据和进行功能控制, 通过shell来进行统计和数据检查和流程控制

## 工具使用
一般来说, 都是先上代码, 不过这次的情况比较特殊, 需要先介绍许多背景工具的信息, 不然代码对应平时没有这么方面基础的开发者来说可能就难以理解了
### adb
adb作为Android开发者来说接显得熟悉的多了, 不过我还是要把使用到的功能进行一个简单的介绍(篇幅有限, 并且很多工具的某个功能详细来说可能就能做一个新的文章了)

adb(Android Debug Bridge), 可以理解为应用开发的一个桥接, 也是用作测试中数据输出和功能控制的的原因

* adb devices: 用于查看当前电脑连接到的手机设备列表, 当有多台设备的时候就可以通过此指令查看需要控制的设备的标识.
* adb -s [deviceId]: 用于通过adb控制指定的设备
* adb logcat -s AUTO_TEST: 用于输出手机中的logcat信息, -s AUTO_TES可以过滤到指定的tag
* adb shell am: am是Activity Manger的缩写, 可以用于控制手机的Activity, 当前使用了**adb shell am force-stop com.clwater.test**可以关闭指定的应用, **adb -s $deviceID shell am start -n com.clwater.test/clwater.test.StartActivity**可以打开指定的应用
* adb shell input tap [x_posotion] [y_position]: 点击手机的指定位置, 可以在开发者模式中显示坐标的信息来获取坐标的情况, 类似的还可以模拟长按或者是滑动等相关的操作


### shell